<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
     "http://www.w3.org/TR/html4/transitional.dtd">
<html>
<head>

  <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
  <title>PowerPoint Presentation</title>
  <meta name="generator" content="LibreOffice 6.4.7.2 (Linux)"/>
  <meta name="author" content="Chad Cottrell"/>
  <meta name="created" content="2020-12-01T18:43:26"/>
  <meta name="changed" content="2021-07-22T17:57:42.238894944"/>
  <meta name="classification" content="[rtnipcontrolcode:rtnipcontrolcodenone||rtnexportcontrolcountry:usa|rtnexportcontrolcode:rtnexportcontrolcodenone||]"/>
  <meta name="description" content="AM Template;"/>
  <meta name="keywords" content="AM, Template"/>
  <meta name="AppVersion" content="16.0000"/>
  <meta name="Company" content="Raytheon"/>
  <meta name="HiddenSlides" content="0"/>
  <meta name="HyperlinksChanged" content="false"/>
  <meta name="LinksUpToDate" content="false"/>
  <meta name="MMClips" content="0"/>
  <meta name="Notes" content="48"/>
  <meta name="PresentationFormat" content="Widescreen"/>
  <meta name="ScaleCrop" content="false"/>
  <meta name="ShareDoc" content="false"/>
  <meta name="Slides" content="48"/>
  <meta name="bjClsUserRVM" content="[]"/>
  <meta name="bjDocumentLabelXML" content="&lt;?xml version=&quot;1.0&quot; encoding=&quot;us-ascii&quot;?&gt;&lt;sisl xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; sislVersion=&quot;0&quot; policy=&quot;cde53ac1-bf5f-4aae-9cf1-07509e23a4b0&quot; origin=&quot;defaultValue&quot; xmlns=&quot;http://www.boldonj"/>
  <meta name="bjDocumentLabelXML-0" content="ames.com/2008/01/sie/internal/label&quot;&gt;&lt;element uid=&quot;bba94c65-ac3d-4f34-b2e1-8de11ef6f01c&quot; value=&quot;&quot; /&gt;&lt;/sisl&gt;"/>
  <meta name="bjDocumentSecurityLabel" content="Origin Jurisdiction: US"/>
  <meta name="bjLabelHistoryID" content="{778CD71A-A7F6-4E73-8765-80EDEEA4D426}"/>
  <meta name="bjSaver" content="A2AB0OuaTTiL2YVHw3qxYann2Jd9uCN6"/>
  <meta name="category" content="AM Template"/>
  <meta name="docIndexRef" content="8469e062-7e12-4929-ab5e-60d5e7a06dc9"/>
  <meta name="rtnexportcontrolcode" content="rtnexportcontrolcodenone"/>
  <meta name="rtnexportcontrolcountry" content="usa"/>
  <meta name="rtnipcontrolcode" content="rtnipcontrolcodenone"/>
</head>
<body text="#000000" bgcolor="#FFFFFF" link="#000000" vlink="#000000" alink="#000000">
<h1><b>Training: Patching Linux</b></h1>
<h2>February 28, 2021</h2>
<h2>O. Chad Cottrell</h2>
<h2>Sr. Systems Administrator II</h2>
<h2>Instructor</h2>
<br>
<h3>Notes:</h3>
<p>Boost glide hypersonic system</p>
<p>Lower Tier Air and Missile Defense Sensor (LTAMDS) </p>
<p>SM-6® missile</p>
<p>The Ku-band Radio Frequency System (KRFS)</p>
<p></p>
<h1 style="page-break-before:always; "></h1>
<p>Intermediate Level – No prerequisite</p>
<p>Reference Document</p>
<p><a href="https://raytheon.sharepoint.us/sites/csar/KB/default.aspx"><u><font color="#CE1126">Home - CAPS-KB (sharepoint.us)</u></font></a></p>
<p>Linux_Patching_User_guide_v4.001.docx</p>
<h1 style="page-break-before:always; "><b>Subject Matter Expert</b></h1>
<ul>
<li>SME: Sandra Villard</li>
<ul>
<li>Sandra.S.Villard@raytheon.com</li>
<li>520-665-5919      </li>
</ul>
<li>SME: Jon Aguilar</li>
<ul>
<li>Jonathon.S.Aguilar@raytheon.com</li>
<li>520-665-5573</li>
</ul>
<li>SME: John Jurgensmeier</li>
<ul>
<li>jajurgensmeier@raytheon.com</li>
<li>520.794.7574</li>
</ul>
</ul>
<h1 style="page-break-before:always; "><b>Instructor: O. Chad Cottrell</b></h1>
<ul>
<li>Chad_Cottrell@Raytheon.com </li>
<li>Member of the ASSIST Team</li>
<li>Been with Raytheon since it was Hughes Aircraft (more the 25 years)</li>
<li>Left for 7 years to consulted for a few years, then contracted to the Army</li>
<li>Then came back – System Admin </li>
</ul>
<h1 style="page-break-before:always; "><b>Lesson Plan</b></h1>
<ul>
<li>Overview</li>
<li>First time setup</li>
<li>Regular Patch Cycle</li>
</ul>
<h1 style="page-break-before:always; "><b>Patching Fundamentals</b></h1>
<h2>Need five things:</h2>
<ul>
<li>Patches and dependencies</li>
<li>Repository to hold the patches</li>
<li>“repodata” directory with information in it to resolve dependencies</li>
<li>Repo file (rhel6.repo, rhel7.repo) to pointing to the repository with the patches and repodata directory</li>
<li>Command to install Patches “yum install –y”</li>
</ul>
<h1 style="page-break-before:always; "><b>1. Patches and Dependencies</b></h1>
<h2>Red Hat workstation 7.9 – 5366 packages (patches or rpms)</h2>
<h2>Patches come out they are in a package with extension rpm</h2>
<h2>Many packages have dependences on other packages</h2>
<h2>Patches come assuming dependences are available</h2>
<h2>                                                          Must have both</h2>
<h2>         New Packages (Patches)                                   All packages on install DVD (5366)</h2>
<h1 style="page-break-before:always; "><b>2. Repository to Hold the Patches</b></h1>
<h1 style="page-break-before:always; "><b>3. “repodata” directory with information in it to resolve dependencies</b></h1>
<p># Createrepo</p>
<h1 style="page-break-before:always; "><b>4. Repo file (rhel6.repo, rhel7.repo) to pointing to the repository with the patches and repodata directory</b></h1>
<h2><b>(Example of a rhel7 server)</b></h2>
<h2><b>/etc/yum.repos.d/rhel7.repo:</b></h2>
<h2>[local_repo_server]</h2>
<h2>name=local_repo_server</h2>
<h2>baseurl=file:///apps/repos/redhat/7/server/</h2>
<h2>#baseurl=http://rh-sat.sp.net/repos/redhat/7/server/</h2>
<h2>gpgcheck=0</h2>
<h2>repo_gpgcheck=0</h2>
<h2>protect=0</h2>
<h2>enabled=1</h2>
<h2>skip-broken=1</h2>
<h2>gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release</h2>
<h2> 	.</h2>
<h2>	.</h2>
<h2>	.</h2>
<h2>                                                                            &gt; yum install -y</h2>
<h2>                                                                </h2>
<h1 style="page-break-before:always; "><b>5. Command to install Patches “yum update –y”
</b></h1>
<p><b># yum clean all      (</b>This will clean out any pre-existing repository entries)</p>
<p><b># yum update –y   </b>(This will execute the update process)</p>
<h1 style="page-break-before:always; "><b>The Final Structure</b></h1>
<p>On Each system</p>
<h1 style="page-break-before:always; "><b>


“Patch setup”</b></h1>
<h1 style="page-break-before:always; "><b>In Tips There is a Spreadsheet with the Steps</b></h1>
<p>https://raytheon.sharepoint.us/sites/csar/KB/default.aspx</p>
<h1 style="page-break-before:always; "><b>Step 1 - Know What You Need</b></h1>
<ul>
<li>You will need to know what major versions of RHEL are on your network</li>
<li>Run the following command on each Linux on your system on your network</li>
<h2><b>                          # cat /etc/redhat-release</b></h2>
<li>Output will look something like this</li>
<h2><b>                           <u>R</u>ed <u>H</u>at <u>E</u>nterprise <u>L</u>inux <u>Workstation</u> release <u>7.9</u> (Maipo)</b></h2>
<li>You will need the rhel7.9-Workstation-sbXxxx.iso &amp; r79since.tgz</li>
</ul>
<h1 style="page-break-before:always; "><b>Summery of Next Steps</b></h1>
<ul>
<li>Create DVDs of install ISO, since</li>
<p>     Patches, update_repo.bash,</p>
<p>     repo files</p>
<li>Create directories patchfiles</li>
<p>      and patchISOs</p>
<li>Copy DVD’s data to correct</li>
<p>     location</p>
<li>Run update_repo.bash</li>
<li>Copy package out of ISO to</li>
<p>     repositories</p>
<li>Update ADDON repositories with</li>
<p>     repodata using createrepo</p>
<li>Copy rhelX.repo to all systems</li>
<li>Run yum install –y on all systems</li>
<li>Validate that patching worked</li>
</ul>
<h1 style="page-break-before:always; "><b>Summery of Next Steps</b></h1>
<ul>
<li>Create DVDs of install ISO, since</li>
<p>     Patches, update_repo.bash,</p>
<p>     repo files</p>
<li>Create directories patchfiles</li>
<p>      and patchISOs</p>
<li>Copy DVD’s data to correct</li>
<p>     location</p>
<li>Run update_repo.bash</li>
<li>Copy package out of ISO to</li>
<p>     repositories</p>
<li>Update ADDON repositories with</li>
<p>     repodata using createrepo</p>
<li>Copy rhelX.repo to all systems</li>
<li>Run yum install –y on all systems</li>
<li>Validate that patching worked</li>
</ul>
<h1 style="page-break-before:always; "><b>Summery of Next Steps</b></h1>
<ul>
<li>Create DVDs of install ISO, since</li>
<p>     Patches, update_repo.bash,</p>
<p>     repo files</p>
<li>Create directories patchfiles</li>
<p>      and patchISOs</p>
<li>Copy DVD’s data to correct</li>
<p>     location</p>
<li>Run update_repo.bash</li>
<li>Copy package out of ISO to</li>
<p>     repositories</p>
<li>Update ADDON repositories with</li>
<p>     repodata using createrepo</p>
<li>Copy rhelX.repo to all systems</li>
<li>Run yum install –y on all systems</li>
<li>Validate that patching worked</li>
</ul>
<h1 style="page-break-before:always; "><b>Summery of Next Steps</b></h1>
<ul>
<li>Create DVDs of install ISO, since</li>
<p>     Patches, update_repo.bash,</p>
<p>     repo files</p>
<li>Create directories patchfiles</li>
<p>      and patchISOs</p>
<li>Copy DVD’s data to correct</li>
<p>     location</p>
<li>Run update_repo.bash</li>
<li>Copy package out of ISO to</li>
<p>     repositories</p>
<li>Update ADDON repositories with</li>
<p>     repodata using createrepo</p>
<li>Copy rhelX.repo to all systems</li>
<li>Run yum install –y on all systems</li>
<li>Validate that patching worked</li>
</ul>
<h1 style="page-break-before:always; "><b>Summery of Next Steps</b></h1>
<ul>
<li>Create DVDs of install ISO, since</li>
<p>     Patches, update_repo.bash,</p>
<p>     repo files</p>
<li>Create directories patchfiles</li>
<p>      and patchISOs</p>
<li>Copy DVD’s data to correct</li>
<p>     location</p>
<li>Run update_repo.bash</li>
<li>Copy package out of ISO to</li>
<p>     repositories</p>
<li>Update ADDON repositories with</li>
<p>     repodata using createrepo</p>
<li>Copy rhelX.repo to all systems</li>
<li>Run yum install –y on all systems</li>
<li>Validate that patching worked</li>
</ul>
<h1 style="page-break-before:always; "><b>Summery of Next Steps</b></h1>
<ul>
<li>Create DVDs of install ISO, since</li>
<p>     Patches, update_repo.bash,</p>
<p>     repo files</p>
<li>Create directories patchfiles</li>
<p>      and patchISOs</p>
<li>Copy DVD’s data to correct</li>
<p>     location</p>
<li>Run update_repo.bash</li>
<li>Copy package out of ISO to</li>
<p>     repositories</p>
<li>Update ADDON repositories with</li>
<p>     repodata using createrepo</p>
<li>Copy rhelX.repo to all systems</li>
<li>Run yum install –y on all systems</li>
<li>Validate that patching worked</li>
</ul>
<h1 style="page-break-before:always; "><b>Summery of Next Steps</b></h1>
<ul>
<li>Create DVDs of install ISO, since</li>
<p>     Patches, update_repo.bash,</p>
<p>     repo files</p>
<li>Create directories patchfiles</li>
<p>      and patchISOs</p>
<li>Copy DVD’s data to correct</li>
<p>     location</p>
<li>Run update_repo.bash</li>
<li>Copy package out of ISO to</li>
<p>     repositories</p>
<li>Update ADDON repositories with</li>
<p>     repodata using createrepo</p>
<li>Copy rhelX.repo to all systems</li>
<li>Run yum install –y on all systems</li>
<li>Validate that patching worked</li>
</ul>
<h1 style="page-break-before:always; "><b>Summery of Next Steps</b></h1>
<ul>
<li>Create DVDs of install ISO, since</li>
<p>     Patches, update_repo.bash,</p>
<p>     repo files</p>
<li>Create directories patchfiles</li>
<p>      and patchISOs</p>
<li>Copy DVD’s data to correct</li>
<p>     location</p>
<li>Run update_repo.bash</li>
<li>Copy package out of ISO to</li>
<p>     repositories</p>
<li>Update ADDON repositories with</li>
<p>     repodata using createrepo</p>
<li>Copy rhelX.repo to all systems</li>
<li>Run yum install –y on all systems</li>
<li>Validate that patching worked</li>
</ul>
<h1 style="page-break-before:always; "><b>Summery of Next Steps</b></h1>
<ul>
<li>Create DVDs of install ISO, since</li>
<p>     Patches, update_repo.bash,</p>
<p>     repo files</p>
<li>Create directories patchfiles</li>
<p>      and patchISOs</p>
<li>Copy DVD’s data to correct</li>
<p>     location</p>
<li>Run update_repo.bash</li>
<li>Copy package out of ISO to</li>
<p>     repositories</p>
<li>Update ADDON repositories with</li>
<p>     repodata using createrepo</p>
<li>Copy rhelX.repo to all systems</li>
<li>Run yum install –y on all systems</li>
<li>Validate that patching worked</li>
</ul>
<h1 style="page-break-before:always; "><b>Step 2 - Get What You Need</b></h1>
<ul>
<li>Based on the list you created in step 1</li>
<li>Locate the Install ISO’s</li>
<li>\\apfs.tuc.us.ray.com\projs\vdeploy\SHB<u> </u>Repository\STANDARD\RHEL&lt;X&gt;</li>
<ul>
<li>rhel&lt;X.X&gt;-Server-sb&lt;Xxx&gt;.iso</li>
<li> rhel&lt;X.X&gt;-Server-sb&lt;Xxx&gt;-checksum.txt </li>
<li>rhel&lt;X.X&gt;-Workstation-sb&lt;Xxx&gt;.iso </li>
<li>rhel&lt;X.X&gt;-Workstation-sb&lt;Xxx&gt;-checksum.txt</li>
</ul>
<li>Burn to your OS ISO bootable(s) “ISO DVD”</li>
<h2>(Note: you can combine files on DVD or Blu-ray, for documentation sake we will treat them as separate DVD's)</h2>
</ul>
<h1 style="page-break-before:always; "><b>Step 3 - Get What You Need</b></h1>
<ul>
<li>Based on the list you created in step 1</li>
<li>Locate Since Patches</li>
<ul>
<li><u>\\apfs.tuc.us.ray.com\projs\vdeploy\catalog\Linux_patches\RHEL&lt;X.X&gt;</u></li>
<li>r&lt;X.X&gt;since.tqz</li>
<li>rhelsincechecksums.txt </li>
<li>update_repo.bash</li>
</ul>
<li>Burn to DVD “Since DVD”</li>
<h2>(Note: you can combine files on one DVD or Blu-ray, for documentation sake we will treat them as separate DVD's)</h2>
</ul>
<h1 style="page-break-before:always; "><b>Step 4 - Get What You Need</b></h1>
<ul>
<li>Get repo files that point to the location of the patches</li>
<ul>
<li>\\apfs.tuc.us.ray.com\projs\vdeploy\catalog\Linux_patches\RHEL&lt;X.X&gt;</li>
<li>rhel6 (this is the repo file)</li>
<li>rhel7 (this is the repo file)</li>
</ul>
<li>Burn to DVD “repo DVD”</li>
<h2>(Note: you can combine files on one DVD or Blu-ray, for documentation sake we will treat them as separate DVD's)</h2>
</ul>
<h1 style="page-break-before:always; "><b>Step 5 – Create top directories</b></h1>
<p>Create the following:</p>
<p># mkdir -p /apps/repos/redhat/patchISOs</p>
<p># chmod 755 /apps/repos/redhat/patchISOs</p>
<p># mkdir -p /apps/repos/redhat/patchfiles</p>
<p># chmod 755 /apps/repos/redhat/patchfiles</p>
<p>Note: &quot;/apps/repos&quot; needs to be an auto mount usually on the</p>
<p>Netapp (file server). (For information refer to training on </p>
<p>auto mounting)</p>
<h1 style="page-break-before:always; "><b>Step 6 – Copy DVD’s to proper location</b></h1>
<p>Copy REPO DVD to /apps/repos/patchfiles:</p>
<p># mount /dev/sr0 /mnt</p>
<p># rsync -av /mnt/ /apps/repos/patchfiles</p>
<p># umount /mnt</p>
<p>Give Script execute permission:</p>
<p># chmod 750 /apps/repos/redhat/patchfiles/*</p>
<p>Copy Install ISO DVD to /apps/repos/patchISOs :</p>
<p># mount /dev/sr0 /mnt</p>
<p># rsync -av /mnt/ /apps/repos/patchISOs</p>
<p># umount /mnt</p>
<p>Copy Since DVD to /apps/repos/patchfiles :</p>
<p># mount /dev/sr0 /mnt</p>
<p># rsync -av /mnt/ /apps/repos/patchfiles</p>
<p># umount /mnt</p>
<h1 style="page-break-before:always; "><b>Step 7 – Run update_repo.bash</b></h1>
<p>Run the update_repo.bash script. This will finish creating the directory structure for the repository, put the “since patches” into the proper directories. Then create repodata for “since patches” by running createrepo.</p>
<p><b># umask 022</b></p>
<p><b># /apps/repos/redhat/patchfiles/update_repo.bash /apps/repos</b></p>
<h1 style="page-break-before:always; "><b>Step 8 – Copy Install ISO data into repo structure</b></h1>
<p>RHEL7.X Server:&nbsp;</p>
<p><b># mount –o loop /apps/repo/redhat/patchISOs/&lt;RHEL7XServ&gt;.iso /mnt</b></p>
<p><b># rsync -av /mnt/ /apps/repos/redhat/7/server</b></p>
<p><b># umount /mnt</b></p>
<p><b>&nbsp;</b></p>
<p>RHEL7.X Workstation:&nbsp;</p>
<p><b># mount –o loop /apps/repo/redhat/patchISOs/&lt;RHEL7XWork&gt;.iso /mnt</b></p>
<p><b># rsync -av /mnt/ /apps/repos/redhat/7/workstation</b></p>
<p><b># umount /mnt</b></p>
<p><b>&nbsp;</b></p>
<p>RHEL6.X Server:&nbsp;</p>
<p><b># mount –o loop /apps/repo/redhat/patchISOs/&lt;RHEL6XServ&gt;.iso /mnt</b></p>
<p><b># rsync -av /mnt/ /apps/repos/redhat/6/server</b></p>
<p><b># umount /mnt</b></p>
<p><b>&nbsp;</b></p>
<p>RHEL6.X Workstation:&nbsp;</p>
<p><b># mount –o loop /apps/repo/redhat/patchISOs/&lt;RHEL6XWork&gt;.iso /mnt </b></p>
<p><b># rsync -av /mnt/ /apps/repos/redhat/6/workstation</b></p>
<p><b># umount /mnt</b></p>
<h1 style="page-break-before:always; "><b>Look at the repo files </b></h1>
<p><u><font color="#1F497D">Repo: /apps/repos/redhat /patchfiles/rhel7.repo</u></font></p>
<p><font color="#1F497D">[local_repo_server]</font></p>
<p><font color="#1F497D">name=local_repo_server</font></p>
<p><font color="#1F497D">baseurl=file:///apps/repos/redhat/7/server/</font></p>
<p><font color="#1F497D">#baseurl=http://rh-sat.sp.net/repos/redhat/7/server/</font></p>
<p><font color="#1F497D">gpgcheck=1</font></p>
<p><font color="#1F497D">repo_gpgcheck=0</font></p>
<p><font color="#1F497D">protect=0</font></p>
<p><font color="#1F497D">enabled=1</font></p>
<p><font color="#1F497D">skip-broken=1</font></p>
<p><font color="#1F497D">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release</font></p>
<p><font color="#1F497D">&nbsp;</font></p>
<p><font color="#1F497D">[local_repo_workstation]</font></p>
<p><font color="#1F497D">name=local_repo_workstation</font></p>
<p><font color="#1F497D">baseurl=file:///apps/repos/redhat/7/workstation/</font></p>
<p><font color="#1F497D">#baseurl=http://rh-sat.sp.net/repos/redhat/7/workstation/</font></p>
<p><font color="#1F497D">gpgcheck=1</font></p>
<p><font color="#1F497D">repo_gpgcheck=0</font></p>
<p><font color="#1F497D">protect=0</font></p>
<p><font color="#1F497D">enabled=1</font></p>
<p><font color="#1F497D">skip-broken=1</font></p>
<p><font color="#1F497D">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release</font></p>
<p><font color="#1F497D">&nbsp;</font></p>
<p><font color="#1F497D">[local_repo_since]</font></p>
<p><font color="#1F497D">name=local_repo_since</font></p>
<p><font color="#1F497D">baseurl=file:///apps/repos/redhat/7/since/packages/</font></p>
<p><font color="#1F497D">#baseurl=http://rh-sat.sp.net/repos/redhat/7/since/packages/</font></p>
<p><font color="#1F497D">gpgcheck=1</font></p>
<p><font color="#1F497D">repo_gpgcheck=0</font></p>
<p><font color="#1F497D">protect=0V</font></p>
<p><font color="#1F497D">enabled=1</font></p>
<p><font color="#1F497D">skip-broken=1</font></p>
<p><font color="#1F497D">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release</font></p>
<p><font color="#1F497D">[local_repo_HighAvailability]</font></p>
<p><font color="#1F497D">name=local_repo_HighAvailability</font></p>
<p><font color="#1F497D">baseurl=file:///apps/repos/redhat/7/server/addons/HighAvailability/</font></p>
<p><font color="#1F497D">#baseurl=http://rh-sat.sp.net/repos/redhat/7/server/addons/HighAvailability/</font></p>
<p><font color="#1F497D">gpgcheck=1</font></p>
<p><font color="#1F497D">repo_gpgcheck=0</font></p>
<p><font color="#1F497D">protect=0</font></p>
<p><font color="#1F497D">enabled=1</font></p>
<p><font color="#1F497D">skip-broken=1</font></p>
<p><font color="#1F497D">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release</font></p>
<p><font color="#1F497D">&nbsp;</font></p>
<p><font color="#1F497D">[local_repo_ResilientStorage]</font></p>
<p><font color="#1F497D">name=local_repo_ResilientStorage</font></p>
<p><font color="#1F497D">baseurl=file:///apps/repos/redhat/7/server/addons/ResilientStorage/</font></p>
<p><font color="#1F497D">#baseurl=http://rh-sat.sp.net/repos/redhat/7/server/addons/ResilientStorage/</font></p>
<p><font color="#1F497D">gpgcheck=1</font></p>
<p><font color="#1F497D">repo_gpgcheck=0</font></p>
<p><font color="#1F497D">protect=0</font></p>
<p><font color="#1F497D">enabled=1</font></p>
<p><font color="#1F497D">skip-broken=1</font></p>
<p><font color="#1F497D">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release</font></p>
<h1 style="page-break-before:always; "><b>Step – 9 Add ADDON to End of *.repo Files </b></h1>
<p><font color="#1F497D">My rhel7.repo file would include these addons repos as follows (This should be done to all OS repo files:</font></p>
<p><font color="#1F497D">.</font></p>
<p><font color="#1F497D">.</font></p>
<p><font color="#1F497D">.</font></p>
<p><font color="#1F497D">protect=0</font></p>
<p><font color="#1F497D">enabled=1</font></p>
<p><font color="#1F497D">skip-broken=1</font></p>
<p><font color="#1F497D">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release</font></p>
<p><font color="#1F497D"></font></p>
<p><font color="#1F497D">[local_repo_workstation_ADDON]</font></p>
<p><font color="#1F497D">name=local_repo_workstation_ADDON</font></p>
<p><font color="#1F497D">baseurl=file:///apps/repos/redhat/7/workstation/addons/ADDON/</font></p>
<p><font color="#1F497D">#baseurl=http://rh-sat.sp.net/repos/redhat/7/workstation/addons/ADDON/</font></p>
<p><font color="#1F497D">gpgcheck=1</font></p>
<p><font color="#1F497D">repo_gpgcheck=0</font></p>
<p><font color="#1F497D">protect=0</font></p>
<p><font color="#1F497D">enabled=1</font></p>
<p><font color="#1F497D">skip-broken=1</font></p>
<p><font color="#1F497D">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release</font></p>
<p><font color="#1F497D">[local_repo_server_ADDON]</font></p>
<p><font color="#1F497D">name=local_repo_server_ADDON</font></p>
<p><font color="#1F497D">baseurl=file:///apps/repos/redhat/7/server/addons/ADDON/</font></p>
<p><font color="#1F497D">#baseurl=http://rh-sat.sp.net/repos/redhat/7/server/addons/ADDON/</font></p>
<p><font color="#1F497D">gpgcheck=1</font></p>
<p><font color="#1F497D">repo_gpgcheck=0</font></p>
<p><font color="#1F497D">protect=0</font></p>
<p><font color="#1F497D">enabled=1</font></p>
<p><font color="#1F497D">skip-broken=1</font></p>
<p><font color="#1F497D">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release</font></p>
<h1 style="page-break-before:always; "><b>Create data that points to ADDON packages (repodata)</b></h1>
<p>7.x:</p>
<p><b># createrepo --update /apps/repos/redhat/7/workstation/ADDON</b></p>
<p>&nbsp;(creates /apps/repos/redhat/7/workstation/ADDON/repodata and files in it)</p>
<p><b># createrepo --update /apps/repos/redhat/7/server/ADDON</b></p>
<p>&nbsp;(creates /apps/repos/redhat/7/server/ADDON/repodata and files in it)</p>
<p>6.x:</p>
<p><b># createrepo --update /apps/repos/redhat/6/server/ADDON</b></p>
<p>(creates /apps/repos/redhat/7/server/ADDON/repodata and files in it)</p>
<p><b></b></p>
<h1 style="page-break-before:always; "><b>Step 10 – Copy *.repo files that points to repodata on 
all systems</b></h1>
<h2><b># rm /etc/yum.repos.d/*.repo</b></h2>
<h2><b># \cp /apps/repos/redhat/patchfiles/rhelX.repo /etc/yum.repos.d/</b></h2>
<h2><b># chmod 640 /etc/yum.repos.d/rhelX.repo</b></h2>
<h1 style="page-break-before:always; "><b>Step 11 – Patch the system (This done on every system)</b></h1>
<h2><b># yum clean all      (</b>This will clean out any pre-existing repository entries)</h2>
<h2><b># yum repolist</b>  (This will display the repositories it is using for the update: use this to verify that the repositories are accessible)<b>  </b></h2>
<h2><b># yum update –y   </b>(This will execute the update process)</h2>
<h2>(If you are ssh’ed into the system)</h2>
<h2><b># cd /var/tmp</b></h2>
<h2><b># nohup yum update –y &amp;&nbsp;&nbsp; </b>(puts nohup.out in /var/tmp/nohup.out)</h2>
<h2><b># tail –f /var/tmp/nohup.out&nbsp;&nbsp; </b>(watch the live output from yum update)</h2>
<h2><b># ctrl-c     </b>(to exit tail command)</h2>
<h2><b># reboot      </b>(If it is a large patch or a maintenance release update such as a kernel update, then a reboot is required)</h2>
<h2>(note: Enter the LUKS password after reboot if you are not using the updateluks.bash script.&nbsp; If you are using the updateluks.bash script, then the you will need to run that script before all reboots when the kernel has been updated.)</h2>
<h1 style="page-break-before:always; "><b>Step 12 – Install Nvidia driver if Kernel is updated</b></h1>
<h2>(Boot the RHEL system to non-graphics mode)</h2>
<h2><b># init 3</b></h2>
<h2>&nbsp;</h2>
<h2><b># cd /apps/repos/redhat/7/workstation/ADDON/hp/</b></h2>
<h2><b># rpm –ivh NVIDIA-Linux-x86_64-390.25.rpm</b></h2>
<h2><b>&nbsp;</b></h2>
<h2>(Switch back to graphics mode or reboot if instructed)</h2>
<h2><b># init 5  </b></h2>
<h1 style="page-break-before:always; "><b>Step 13 – Verification of Patches</b></h1>
<h2>To verify that patches have been successful or not, query the log directory for this data.  These are kept in the /var/log/yum.log. The history can also be queried with the yum history command.   </h2>
<h2>&nbsp;</h2>
<h2><b># yum history </b></h2>
<h2><b>&nbsp;</b></h2>
<h2><b></b></h2>
<h2><b></b></h2>
<h2><b>&nbsp;</b></h2>
<h2>(Run the following command to see more specific range of ID’s)</h2>
<h2><b>#</b> <b>yum history list 3..6</b></h2>
<h2>(Run the following commands to see more specifics on a particular package)</h2>
<h2><b>#</b> <b>yum info kernel</b></h2>
<h2><b>#</b> <b>yum info openssh-server</b></h2>
<h1 style="page-break-before:always; "><b>


“Regular Patch Cycle”</b></h1>
<h1 style="page-break-before:always; "><b>Step 1 - Get the Since Patches</b></h1>
<ul>
<li>Based on the list you created in step 1</li>
<li>Locate Since Patches</li>
<ul>
<li><u>\\apfs.tuc.us.ray.com\projs\vdeploy\catalog\Linux_patches\RHEL&lt;X.X&gt;</u></li>
<li>r&lt;X.X&gt;since.tqz</li>
<li>rhelsincechecksums.txt </li>
<li>update_repo.bash</li>
</ul>
<li>Burn to DVD “Since DVD”</li>
<h2>(Note: you can combine files on one DVD or Blu-ray, for documentation sake we will treat them as separate DVD's)</h2>
</ul>
<h1 style="page-break-before:always; "><b>Step 2 – Place items in proper location</b></h1>
<p>Copy Since DVD to /apps/repos/patchfiles :</p>
<p># mount /dev/sr0 /mnt</p>
<p># rsync -av /mnt/ /apps/repos/patchfiles</p>
<p># umount /mnt</p>
<h1 style="page-break-before:always; "><b>Step 3 – Execute update_repo.bash</b></h1>
<p> Give Script execute permission and execute:</p>
<p># chmod +x /apps/repos/redhat/patchfiles/update_repo.bash</p>
<p># /apps/repos/redhat/patchfiles/update_repo.bash /apps/repos</p>
<h1 style="page-break-before:always; "><b>Step 4 – Patch the system (This done on every system)</b></h1>
<h2><b># yum clean all      (</b>This will clean out any pre-existing repository entries)</h2>
<h2><b># yum repolist</b>  (This will display the repositories it is using for the update: use this to verify that the repositories are accessible)<b>  </b></h2>
<h2><b># yum update –y   </b>(This will execute the update process)</h2>
<h2> (If you are ssh’ed into the system)</h2>
<h2><b># cd /var/tmp</b></h2>
<h2><b># nohup yum –y update &amp;&nbsp;&nbsp; </b>(puts nohup.out in /var/tmp/nohup.out)</h2>
<h2><b># tail –f /var/tmp/nohup.out&nbsp;&nbsp; </b>(watch the live output from yum update)</h2>
<h2><b># ctrl-c     </b>(to exit tail command)</h2>
<h2><b># reboot      </b>(If it is a large patch or a maintenance release update such as a kernel update, then a reboot is required)</h2>
<h2>(note: Enter the LUKS password after reboot if you are not using the updateluks.bash script.&nbsp; If you are using the updateluks.bash script, then the you will need to run that script before all reboots when the kernel has been updated.)</h2>
<h1 style="page-break-before:always; "><b>Step 5 – Install Nvidia Driver if Kernel is Updated</b></h1>
<h2><b># init 3 </b>(Boot the RHEL system to single user mode)</h2>
<h2>&nbsp;</h2>
<h2><b># cd /apps/repos/redhat/7/workstation/ADDON/hp/</b></h2>
<h2> </h2>
<h2><b># rpm –ivh NVIDIA-Linux-x86_64-390.25.rpm</b></h2>
<h2><b>&nbsp;</b></h2>
<h2><b># init 5  </b>(Switch back to graphics mode of reboot if instructed)</h2>
<h1 style="page-break-before:always; "><b>Step 6 – Verification of Patches</b></h1>
<h2>To verify that patches have been successful or not, query the log directory for this data.  These are kept in the /var/log/yum.log. The history can also be queried with the yum history command.   </h2>
<h2>&nbsp;</h2>
<h2><b># yum history </b></h2>
<h2><b>&nbsp;</b></h2>
<h2><b></b></h2>
<h2><b></b></h2>
<h2><b>&nbsp;</b></h2>
<h2>(Run the following command to see more specific range of ID’s)</h2>
<h2><b>#</b> <b>yum history list 3..6</b></h2>
<h2>(Run the following commands to see more specifics on a particular package)</h2>
<h2><b>#</b> <b>yum info kernel</b></h2>
<h2><b>#</b> <b>yum info openssh-server</b></h2>
<h1 style="page-break-before:always; "><b>TIPS

\\apfs\projs\standardbuild\training\001C-RHEL-Patching
Chad_Cottrell@raytheon.com</b></h1>
<h1 style="page-break-before:always; "><b>Thank you.</b></h1>
<h1 style="page-break-before:always; "></h1>
</body>
</html>